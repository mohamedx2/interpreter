# Create a simple solid blue 16x16 ICO file manually
$bytes = @(
    # ICO header
    0x00, 0x00, 0x01, 0x00, 0x01, 0x00, 
    # Icon directory entry  
    0x10, 0x10, 0x00, 0x00, 0x01, 0x00, 0x20, 0x00, 
    0x00, 0x04, 0x00, 0x00, 0x16, 0x00, 0x00, 0x00,
    # BMP header
    0x28, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
    0x20, 0x00, 0x00, 0x00, 0x01, 0x00, 0x20, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
)

# Add 16x16 blue pixels (256 pixels * 4 bytes each = 1024 bytes)
for($i = 0; $i -lt 256; $i++) {
    $bytes += @(0xFF, 0x00, 0x55, 0xA4) # BGRA: Blue with alpha
}

# AND mask (all 0s for opaque)
for($i = 0; $i -lt 32; $i++) {
    $bytes += 0x00
}

[System.IO.File]::WriteAllBytes("simple.ico", [byte[]]$bytes)
Write-Host "Simple ICO created"
